@{
    List<md_Planilha.mdJaneiro> mdjaneiro = ViewBag.planilhaGeral;
    List<md_Planilha.mdJaneiro> primeiroTotal = ViewBag.primeiroTotal;
    List<md_Planilha.mdJaneiro> segundoTotal = ViewBag.segundoTotal;
    List<md_Planilha.mdJaneiro> FaturamentoResult = ViewBag.FaturamentoResult;
    List<md_Planilha.mdJaneiro> primeiroResultado = ViewBag.primeiroResultado;
    List<md_Planilha.mdJaneiro> segundoResultado = ViewBag.segundoResultado;
    List<md_Planilha.mdJaneiro> sobre = ViewBag.sobre;
    List<md_Planilha.mdJaneiro> contribDespesas = ViewBag.despesas;
    md_Planilha.mdJaneiro totalDespesas = ViewBag.totaldespesas;
    md_Planilha.mdJaneiro totalSobre = ViewBag.totalSobre;
    md_Planilha.mdJaneiro propResult = ViewBag.propResultado;
    md_Planilha.mdJaneiro realiResult = ViewBag.realiResultado;
    md_Planilha.mdJaneiro propostaTabResultado = ViewBag.propostaTabResultado;
    md_Planilha.mdJaneiro realizadoTabResultado = ViewBag.realizadoTabResultado;
    ViewBag.Title = "Planilha";
    var a = 0;
    Layout = "~/Views/Shared/_RenderImpressao.cshtml";
}

<body>
    <div class="container">
        <div>
            <center><h2>Planilha</h2></center>
        </div>
        <div class="tabela">
        <table>
            <tr>
                <th style="text-align:center;" colspan="2">Categoria</th>
                <th style="text-align:center;" colspan="2">Janeiro</th>
                <th style="text-align:center;" colspan="2">Fevereiro</th>
                <th style="text-align:center;" colspan="2">Março</th>
                <th style="text-align:center;" colspan="2">Abril</th>
                <th style="text-align:center;" colspan="2">Maio</th>
                <th style="text-align:center;" colspan="2">Junho</th>

            </tr>
            <tr>
                <td></td>
                <td></td>
                <td>Proposta</td>
                <td>Realizado</td>
                <td>Proposta</td>
                <td>Realizado</td>
                <td>Proposta</td>
                <td>Realizado</td>
                <td>Proposta</td>
                <td>Realizado</td>
                <td>Proposta</td>
                <td>Realizado</td>
                <td>Proposta</td>
                <td>Realizado</td>
            </tr>
            @foreach (var p in mdjaneiro)
            {
                a += 1;
                <tr>
                    <td>@a</td>
                    <td>@p.Categoria</td>
                    <td>@p.JanProposta.ToString("#,##0.00")</td>
                    <td>@p.JanRealizado.ToString("#,##0.00")</td>
                    <td>@p.FevProposta.ToString("#,##0.00")</td>
                    <td>@p.FevRealizado.ToString("#,##0.00")</td>
                    <td>@p.MarProposta.ToString("#,##0.00")</td>
                    <td>@p.MarRealizado.ToString("#,##0.00")</td>
                    <td>@p.AbrProposta.ToString("#,##0.00")</td>
                    <td>@p.AbrRealizado.ToString("#,##0.00")</td>
                    <td>@p.MaiProposta.ToString("#,##0.00")</td>
                    <td>@p.MaiRealizado.ToString("#,##0.00")</td>
                    <td>@p.JunProposta.ToString("#,##0.00")</td>
                    <td>@p.JunRealizado.ToString("#,##0.00")</td>

                </tr>
            }
            <tfoot>
                <tr>
                    <td></td>
                    <td class="total">Total</td>
                    @foreach (var t in primeiroTotal)
                    {
                        <td>@t.TotalProposta.ToString("#,##0.00")</td>
                        <td>@t.TotalRealizado.ToString("#,##0.00")</td>
                    }
                </tr>
                <tr>
                    <td></td>
                    <td class="total">Resultado</td>
                    @foreach (var pr in primeiroResultado)
                    {
                        <td>@pr.TotalPropResultado.ToString("#,##0.00")</td>
                        <td>@pr.TotalRealiResultado.ToString("#,##0.00")</td>
                    }
                </tr>
            </tfoot>
        </table>
        <br />

        @*Inicio da segunda parte da tabela*@
        <table>
            <tr>
                <th colspan="2">Categoria</th>
                <th colspan="2">Julho</th>
                <th colspan="2">Agosto</th>
                <th colspan="2">Setembro</th>
                <th colspan="2">Outubro</th>
                <th colspan="2">Novembro</th>
                <th colspan="2">Dezembro</th>
            </tr>
            <tr>
                <td></td>
                <td></td>
                <td>Proposta</td>
                <td>Realizado</td>
                <td>Proposta</td>
                <td>Realizado</td>
                <td>Proposta</td>
                <td>Realizado</td>
                <td>Proposta</td>
                <td>Realizado</td>
                <td>Proposta</td>
                <td>Realizado</td>
                <td>Proposta</td>
                <td>Realizado</td>
            </tr>
            @foreach (var p in mdjaneiro)
            {
                a += 1;
                <tr>
                    <td>@a</td>
                    <td>@p.Categoria</td>
                    <td>@p.JulProposta.ToString("#,##0.00")</td>
                    <td>@p.JulRealizado.ToString("#,##0.00")</td>
                    <td>@p.AgoProposta.ToString("#,##0.00")</td>
                    <td>@p.AgoRealizado.ToString("#,##0.00")</td>
                    <td>@p.SetProposta.ToString("#,##0.00")</td>
                    <td>@p.SetRealizado.ToString("#,##0.00")</td>
                    <td>@p.OutProposta.ToString("#,##0.00")</td>
                    <td>@p.OutRealizado.ToString("#,##0.00")</td>
                    <td>@p.NovProposta.ToString("#,##0.00")</td>
                    <td>@p.NovRealizado.ToString("#,##0.00")</td>
                    <td>@p.DezProposta.ToString("#,##0.00")</td>
                    <td>@p.DezRealizado.ToString("#,##0.00")</td>
                </tr>
            }
            <tr class="rodape">
                <td></td>
                <td class="total">Total</td>
                @foreach (var t in segundoTotal)
                {
                    <td>@t.TotalProposta.ToString("#,##0.00")</td>
                    <td>@t.TotalRealizado.ToString("#,##0.00")</td>
                }
            </tr>
            <tr>
                <td></td>
                <td class="total">Resultado</td>
                @foreach (var sr in segundoResultado)
                {
                    <td>@sr.TotalPropResultado.ToString("#,##0.00")</td>
                    <td>@sr.TotalRealiResultado.ToString("#,##0.00")</td>
                }
            </tr>
        </table>
        <br />

        <div class="box">
            <table class="resultado">
                <thead>
                    <tr>
                        <th colspan="3">Resultado</th>
                    </tr>
                    <tr>
                        <td></td>
                        <td>Proposta Total</td>
                        <td>Realizado Total</td>
                    </tr>
                </thead>
                <tbody>

                    @foreach (var fatR in FaturamentoResult)
                    {
                        <tr>
                            <td>@fatR.Categoria</td>
                            <td>@fatR.FaturamentoPropResult.ToString("#,##0.00") </td>
                            <td>@fatR.FaturamentoRealiResult.ToString("#,##0.00")</td>
                        </tr>
                    }
                    <tr>
                        <td class="total">Total</td>
                        <td>@propResult.PropResultado</td>
                        <td>@realiResult.RealiResultado</td>
                    </tr>
                    <tr>
                        <td class="total">Resultado</td>
                        <td>@propostaTabResultado.PropostaTabResultado.ToString("#,##0.00") </td>
                        <td>@realizadoTabResultado.RealizadoTabResultado.ToString("#,##0.00") </td>
                    </tr>
                </tbody>
            </table>
        </div>
        <div class="box">
            <table class="tabelas">
                <tr>
                    <th>&nbsp;</th>
                </tr>
                <tr>
                    <td>% Sobre o Faturamento</td>
                </tr>
                <tr>
                    <td>&nbsp;</td>
                </tr>
                @foreach (var sob in sobre)

                {
                    <tr>
                        <td>@sob.SobreFaturamento.ToString("#,##0.00")%</td>
                    </tr>
                }
                <tr>
                    <td>@totalSobre.TotalSobreFaturamento.ToString("#,##0.00") %</td>
                </tr>
                <tr>
                    <td>&nbsp;</td>
                </tr>
            </table>
        </div>

        <div class="box">
            <table class="tabelas">
                <tr>
                    <th>&nbsp;</th>
                </tr>
                <tr>
                    <td>% Contribuição Despesas</td>
                </tr>
                <tr>
                    <td>&nbsp;</td>
                </tr>
                @foreach (var desp in contribDespesas)
                {
                    <tr>
                        <td>@desp.ContribuicaoDespesas.ToString("#,##0.00") %</td>
                    </tr>
                }
                <tr>
                    <td>@totalDespesas.TotalContribDespesas.ToString("#,##0.00") %</td>
                </tr>
                <tr>
                    <td>&nbsp;</td>
                </tr>
            </table>
        </div>
    </div>
    <br />
    <br />
    <br />
</div>
</body>

